<!-- <% layout('layout/boilerplate') %>
 <div class="row mb-3">
    <h1 class="text-center">New campgrgound </h1>
 </div>

 <form action="/campgrounds" method="post" novalidate class="validated-form" enctype="multipart/form-data">
    <div class="row mb-3">
      <label for="title" class="col-sm-2 col-form-label">Title</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" id="title" name="campground[title]" required>
        <div class="valid-feedback">
          Looks good!
        </div>
        <div class="invalid-feedback">
          Please choose a Title.
        </div>
      </div>
    </div>
    <div class="row mb-3">
      <label for="location" class="col-sm-2 col-form-label">Location</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" id="location" name="campground[location]" required>
        <div class="valid-feedback">
          Looks good!
        </div>
        <div class="invalid-feedback">
          Please choose a location.
        </div>
      </div>
      <div class="row mb-3 mt-3">
        <label for="locationMap" class="col-sm-2 col-form-label">Location Map</label>
        <div class="col-sm-10">
          <div id="locationMap" style="height: 400px; border: 1px solid #ccc;"></div>
        </div>
      </div>
      
    </div>
    <div class="row mb-3">
      <label for="images" class="col-sm-2 col-form-label">Images</label>
      <div class="row mb-3">
        <label class="col-sm-2 col-form-label">Upload Images</label>
        <div class="col-sm-10">
          <div id="dropzone" class="border p-3 text-center rounded bg-light">
            <p class="mb-2">Drag & Drop files here or click to select</p>
            <input type="file" id="imageUpload" name="images" multiple class="form-control d-none">
            <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('imageUpload').click()">Choose Files</button>
          </div>
          <div id="preview" class="mt-3 d-flex flex-wrap"></div>
          <div class="invalid-feedback">Please upload at least one image.</div>
        </div>
      </div>
    
  </div>
</div>  
        <div class="row mb-3">
            <label for="image" class="col-sm-2 col-form-label">Description</label>
            <div class="col-sm-10">
              <textarea type="text" class="form-control" id="description" name="campground[description]" required></textarea>
              <div class="valid-feedback">
                Looks good!
              </div>
              <div class="invalid-feedback">
                Please choose a Description.
              </div>
            </div>
            </div>  
            <div class="mb-3">
            <div class="input-group">
                <label for="price" class="col-sm-2 col-form-label">Campground Price</label>
                <span class="input-group-text">$</span>
                <input type="number" id="price" class="form-control" name="campground[price]" required aria-label="Amount (to the nearest dollar)" placeholder="0.00">
                
              </div>
            </div>
   <div> <button type="submit" class="btn btn-primary">ADD</button></div> 
  </form>
  <script src="/maps/newcampgroundmap.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      if (typeof newcampgroundmap === "function") {
        newcampgroundmap();
      } else {
        console.error("Error: newcampgroundmap is not defined!");
      }
    });
  </script>
   
   -->
   <% layout('layout/boilerplate') %>
   <title>New Campground</title>

   <div class="row mb-3">
     <h1 class="text-center">New Campground</h1>
   </div>
   
   <form action="/campgrounds" method="post" novalidate class="validated-form" enctype="multipart/form-data">
     <div class="row mb-3">
       <label for="title" class="col-sm-2 col-form-label">Title</label>
       <div class="col-sm-10">
         <input type="text" class="form-control" id="title" name="campground[title]" required>
         <div class="valid-feedback">Looks good!</div>
         <div class="invalid-feedback">Please choose a Title.</div>
       </div>
     </div>
   
     <!-- Map Location Field -->
     <div class="row mb-3">
       <label for="location" class="col-sm-2 col-form-label">Location</label>
       <div class="col-sm-10">
         <input type="text" class="form-control" id="location" name="campground[location]" required>
         <div class="valid-feedback">Looks good!</div>
         <div class="invalid-feedback">Please choose a location.</div>
       </div>
     </div>
     
     <!-- Map Container -->
     <div class="row mb-3 mt-3">
       <label for="locationMap" class="col-sm-2 col-form-label">Location Map</label>
       <div class="col-sm-10">
         <div id="locationMap" style="height: 400px; border: 1px solid #ccc;"></div>
       </div>
     </div>
   
     <div class="row mb-3">
       <label for="images" class="col-sm-2 col-form-label">Images</label>
       <div class="row mb-3">
         <label class="col-sm-2 col-form-label">Upload Images</label>
         <div class="col-sm-10">
           <div id="dropzone" class="border p-3 text-center rounded bg-light">
             <p class="mb-2">Drag & Drop files here or click to select</p>
             <input type="file" id="imageUpload" name="images" multiple class="form-control d-none">
             <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('imageUpload').click()">Choose Files</button>
           </div>
           <div id="preview" class="mt-3 d-flex flex-wrap"></div>
           <div class="invalid-feedback">Please upload at least one image.</div>
         </div>
       </div>
     </div>
   
     <div class="row mb-3">
       <label for="description" class="col-sm-2 col-form-label">Description</label>
       <div class="col-sm-10">
         <textarea type="text" class="form-control" id="description" name="campground[description]" required></textarea>
         <div class="valid-feedback">Looks good!</div>
         <div class="invalid-feedback">Please choose a Description.</div>
       </div>
     </div>
   
     <div class="mb-3">
       <div class="input-group">
         <label for="price" class="col-sm-2 col-form-label">Campground Price</label>
         <span class="input-group-text">$</span>
         <input type="number" id="price" class="form-control" name="campground[price]" required aria-label="Amount (to the nearest dollar)" placeholder="0.00">
       </div>
     </div>
   
     <div><button type="submit" class="btn btn-primary">ADD</button></div>
   </form>
   <script>
    (function () {
      'use strict';
      var forms = document.querySelectorAll('.validated-form');
  
      Array.prototype.slice.call(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    })();
  
    // File Upload Preview & Validation
    document.getElementById("imageUpload").addEventListener("change", function (event) {
      const preview = document.getElementById("preview");
      preview.innerHTML = "";
      const maxFileSize = 10 * 1024 * 1024; // 10MB limit
  
      Array.from(event.target.files).forEach(file => {
        if (file.size > maxFileSize) {
          alert("File size exceeds 10MB: " + file.name);
          return;
        }
  
        const reader = new FileReader();
        reader.onload = function (e) {
          const img = document.createElement("img");
          img.src = e.target.result;
          img.className = "m-1 rounded border";
          img.style.width = "100px";
          img.style.height = "100px";
          preview.appendChild(img);
        };
        reader.readAsDataURL(file);
      });
    });
  
    // Drag & Drop File Upload
    const dropzone = document.getElementById("dropzone");
    dropzone.addEventListener("dragover", function (event) {
      event.preventDefault();
      dropzone.classList.add("border-primary");
    });
  
    dropzone.addEventListener("dragleave", function () {
      dropzone.classList.remove("border-primary");
    });
  
    dropzone.addEventListener("drop", function (event) {
      event.preventDefault();
      dropzone.classList.remove("border-primary");
      document.getElementById("imageUpload").files = event.dataTransfer.files;
      document.getElementById("imageUpload").dispatchEvent(new Event("change"));
    });
  </script>
  
<script src="/javascripts/mapfornew.js"></script>